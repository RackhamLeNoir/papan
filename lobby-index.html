<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Papan</title>

    <script src="bower_components/webcomponentsjs/webcomponents-lite.js"></script>
    <script src="node_modules/deep-diff/releases/deep-diff-0.3.4.min.js"></script>
    <script src="node_modules/event-emitter-es6/dist/event-emitter.min.js"></script>

    <script src="src/common/utils.js"></script>
    <script src="src/client/channel.js"></script>
    <script src="src/client/lobbyinterface.js"></script>

    <link rel="import" href="template/mainwindow.html">

    <style is="papan-style">
      html:not([style-scope]):not(.style-scope),body:not([style-scope]):not(.style-scope) {
        margin: 0;
          font-family: 'Roboto', 'Noto', sans-serif;
          -webkit-font-smoothing: antialiased;
          background: #f1f1f1;
      }

      .js-off {
        display: none;
      }
    </style>

    <script>
      (() => {
        console.log('start')
        let documentLoaded = new Promise((resolve, reject) => {
          window.addEventListener('load', () => resolve())
        })
        let channelReady = new Promise((resolve, reject) => {
          if (channel.ready()) {
            resolve()
          } else {
            channel.onready = resolve
          }
        })
        Promise.all([
          documentLoaded,
          channelReady
        ])
        .then(() => {
          const main = document.createElement('papan-main-window')
          document.getElementById('maindiv').appendChild(main)
        })
      })()
    </script>

    <noscript>
      <style is="papan-js-off">
        .js-on {
          display: hidden;
        }

        .js-off {
          display: inline;
        }
      </style>
    </noscript>
  </head>
  <body>
    <div class="js-on" id="maindiv"></div>
    <div class="js-off">
      <h2>Very sorry, but JavaScript is absolutely required here.</h2>
    </div>
  </body>
</html>
