<link rel="import" href="gamebadge.html">
<link rel="import" href="data/localize.html">
<!--link rel="import" href="data/userinfo.html"-->

<dom-module id="papan-game-list">
  <link rel="import" type="css" href="gamelist.css">
  <template>
    <!--template is="dom-if" if="{{user.islogged}}">
      <user-info userid=[[user.username]] userinfo={{_userinfo}}></user-info-->
      <div id="user-games-list">
        <template is="dom-repeat" items="[[_gamelist]]">
          <papan-game-badge gamename=[[item.name]] gameinfo=[[item.info]] lobby="[[lobby]]" server="[[server]]"></papan-game-badge>
        </template>
      </div>
    <!--/template>
    <template is="dom-if" if="{{!user.islogged}}">
      You have to login
    </template-->
  </template>

  <script>
    'use strict'

    Polymer({
      is: "papan-game-list",

      properties: {
        /*
          user who owns the games
        */
        user: {
          type: Object
        },

        server: {
          type: Object
        },

        lobby: {
          type: Object
        },

        _gamelist: {
          type: Array,
          value: () => [],
          notify: true
        }
      },

      behaviors: [
        PapanLocalize
      ],

      ready: function() {
        lobbyInterface.on('games', gamelist => {
          //gamelist: map<string, Papan.GameInfo>
          this._gamelist = Object.keys(gamelist).map(function(key) {
            console.log('Found game: ' + key)
            return {
              name: key,
              info: gamelist[key]
            };
          });
          console.log(this._gamelist)
        })
      }
    })
  </script>
</dom-module>
